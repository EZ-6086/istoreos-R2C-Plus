# ============================================
# iStoreOS for NanoPi R2C Plus 精简版配置文件
# 专门为 GitHub Actions 优化，节省磁盘空间
# 编译时间: $(date)
# ============================================

# ===== 目标配置 =====
CONFIG_TARGET_rockchip=y
CONFIG_TARGET_rockchip_armv8=y
CONFIG_TARGET_rockchip_armv8_DEVICE_friendlyarm_nanopi-r2c-plus=y

# ===== 系统配置 =====
CONFIG_TARGET_ROOTFS_PARTSIZE=128  # 最小分区大小
CONFIG_TARGET_IMAGES_GZIP=y
CONFIG_TARGET_ROOTFS_SQUASHFS=y

# ===== 网络配置 =====
CONFIG_TARGET_IP_ADDR="192.168.101.1"
CONFIG_TARGET_NETMASK="255.255.255.0"

# ===== 内核配置 =====
CONFIG_LINUX_6_6=y

# ===== 硬件驱动（必须） =====
CONFIG_PACKAGE_kmod-usb-net-rtl8152=y
CONFIG_PACKAGE_kmod-r8169=y
CONFIG_PACKAGE_kmod-phy-realtek=y
CONFIG_PACKAGE_kmod-crypto-rockchip=y
CONFIG_PACKAGE_kmod-hw-random-rockchip=y
CONFIG_PACKAGE_kmod-dwmmc-rockchip=y
CONFIG_PACKAGE_kmod-usb2=y
CONFIG_PACKAGE_kmod-usb3=y
CONFIG_PACKAGE_kmod-usb-net=y
CONFIG_PACKAGE_kmod-usb-storage=y

# ===== iStoreOS核心（最小集） =====
CONFIG_PACKAGE_iStore=y
CONFIG_PACKAGE_luci-app-store=y
CONFIG_PACKAGE_luci-app-quickstart=y

# ===== FriendlyWrt核心 =====
CONFIG_PACKAGE_friendlywrt-base=y
CONFIG_PACKAGE_nanopi-r2c-plus-support=y

# ===== 基础系统（最小集） =====
CONFIG_PACKAGE_dnsmasq-full=y
CONFIG_PACKAGE_firewall4=y
CONFIG_PACKAGE_uhttpd=y
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-ssl=y
CONFIG_PACKAGE_luci-theme-argon=y
CONFIG_PACKAGE_luci-i18n-base-zh-cn=y

# ===== 存储支持（基本） =====
CONFIG_PACKAGE_kmod-fs-ext4=y
CONFIG_PACKAGE_kmod-fs-squashfs=y
CONFIG_PACKAGE_block-mount=y
CONFIG_PACKAGE_fdisk=y

# ===== 网络优化 =====
CONFIG_PACKAGE_kmod-tcp-bbr=y
CONFIG_PACKAGE_kmod-nft-offload=y

# ===== 基础工具（绝对必要） =====
CONFIG_PACKAGE_curl=y
CONFIG_PACKAGE_openssh-sftp-server=y
CONFIG_PACKAGE_ca-bundle=y
CONFIG_PACKAGE_unzip=y
CONFIG_PACKAGE_iputils-ping=y
CONFIG_PACKAGE_bash=y

# ===== 禁用所有大型包 =====
# Docker
# CONFIG_PACKAGE_dockerd is not set
# CONFIG_PACKAGE_docker-compose is not set
# CONFIG_PACKAGE_luci-app-dockerman is not set

# Python
# CONFIG_PACKAGE_python3 is not set
# CONFIG_PACKAGE_python3-pip is not set
# CONFIG_PACKAGE_python3-setuptools is not set

# Node.js
# CONFIG_PACKAGE_node is not set
# CONFIG_PACKAGE_node-npm is not set

# 打印服务器
# CONFIG_PACKAGE_cups is not set
# CONFIG_PACKAGE_kmod-usb-printer is not set
# CONFIG_PACKAGE_p910nd is not set

# Samba
# CONFIG_PACKAGE_samba4-server is not set
# CONFIG_PACKAGE_luci-app-samba4 is not set

# 开发工具
# CONFIG_PACKAGE_git is not set
# CONFIG_PACKAGE_golang is not set

# 大型诊断工具
# CONFIG_PACKAGE_nmap is not set
# CONFIG_PACKAGE_tcpdump is not set
# CONFIG_PACKAGE_iftop is not set

# VPN/高级网络
# CONFIG_PACKAGE_openvpn-openssl is not set
# CONFIG_PACKAGE_luci-app-openvpn is not set
# CONFIG_PACKAGE_wireguard-tools is not set

# 高级监控
# CONFIG_PACKAGE_lm-sensors is not set
# CONFIG_PACKAGE_smartmontools is not set
# CONFIG_PACKAGE_vnstat is not set

# 压缩工具（保留最小集）
# CONFIG_PACKAGE_unrar is not set
# CONFIG_PACKAGE_p7zip is not set
# CONFIG_PACKAGE_xz-utils is not set

# 其他大型包
# CONFIG_PACKAGE_luci-app-fileassistant is not set
# CONFIG_PACKAGE_luci-app-istorex is not set
# CONFIG_PACKAGE_luci-app-turboacc is not set
# CONFIG_PACKAGE_luci-app-ttyd is not set
# CONFIG_PACKAGE_ttyd is not set
# CONFIG_PACKAGE_luci-app-upnp is not set
# CONFIG_PACKAGE_miniupnpd is not set
# CONFIG_PACKAGE_luci-app-wol is not set
# CONFIG_PACKAGE_etherwake is not set
# CONFIG_PACKAGE_luci-app-smartdns is not set
# CONFIG_PACKAGE_smartdns is not set
# CONFIG_PACKAGE_fail2ban is not set
# CONFIG_PACKAGE_luci-app-fail2ban is not set
# CONFIG_PACKAGE_rng-tools is not set

# ===== 构建优化 =====
CONFIG_DEBUG_INFO=n
CONFIG_STRIP_KERNEL_EXPORTS=y
CONFIG_KERNEL_MODULE_COMPRESS_XZ=y
CONFIG_KERNEL_DEBUG_INFO=n
CONFIG_KERNEL_DEBUG_KERNEL=n
CONFIG_KERNEL_DEBUG_FS=n

# 最小化调试符号
CONFIG_SYMBOLIC_ERROE_MESSAGES=n
CONFIG_DEBUG_MISC=n

# 关闭不必要的内核特性
CONFIG_KALLSYMS=n
CONFIG_FTRACE=n
CONFIG_DEBUG_BUGVERBOSE=n
CONFIG_DEBUG_INFO_REDUCED=y